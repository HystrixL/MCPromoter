# Changelog

## [0.1.0] - 2021-07-01
万恶之源
#### 新增

- 模块基本框架搭建
- 开始从旧作MCDP-V1.3.0移植内容


## [0.2.0] - 2021-07-02
面向Ctrl C+V的功能移植进程
### 新增

- 使用实例字典的方式完成玩家及服务器信息的存储
- 多线程获取信息实现
- 继续进行MCDP-V1.3.0功能的移植

### 更改

- 完善PlayerDatas类及GameDatas类
- 逐步规范命名规则

### 修复

- @mcd导致崩服的bug


## [1.0.0] - 2021-07-03
喜欢吗？砍了。
### 新增

- 基本完成MCDP-V1.3.0功能的全部移植
- 加入新的自杀提示信息(整活)
- 完成帮助信息

### 更改

- 完善指令操作反馈，尽量降低对其他玩家的干扰
- 优化部分实例实例化的位置，以优化插件运行效果
- @sh更名为@rc

### 修复

- @mcd导致崩服的bug

### 移除

- @load、@qb、@health、跨世界传送


## [1.0.1] - 2021-07-03
每次实装@=第一次都会有bug
### 更改

- 微调@=的使用方式
- 精简代码

### 修复

- 修复@=、@ki status、@mg status无效的bug


## [1.1.0] - 2021-07-03

### 新增

- 实现玩家退服后死亡记录点的持续保存


## [1.1.1] - 2021-07-04
奠基*1
### 新增

- 完成配置文件读取与写入的类

### 更改

- 继续精简代码
- 完善了几个可能会导致bug的小细节

## [1.2.0] - 2021-07-05
重构了好多内容，实现了一直想做的配置文件
### 新增

- 完成插件加载时配置文件的初始化、读取及处理
- 现在可通过修改配置文件快速更改存档名、反作弊开关、白名单、admin权限名单、指令白名单、自定义自杀信息、指令前缀而无需重新编译插件
- 实现基于MCP的插件内置玩家白名单机制，可不依赖于Microsoft的白名单，避免受其服务器抽风的影响。

### 更改

- 将存档名、反作弊开关、白名单、admin权限名单、指令白名单、自定义自杀信息、指令前缀通过数组/变量的方式存储，便于进行修改
- 优化@=的表达式提取逻辑
- 优化@rc的指令提取逻辑
- 优化自定义自杀信息的处理逻辑
- 优化@ban及@rc的admin权限判断逻辑
- 优化越权使用@ban及@rc的信息提示，并取消自动踢出
- 优化反作弊判断逻辑，使其更加严格

## [1.2.1] - 2021-07-05
水版本号*1
### 新增

- 插件配置文件初始化及加载的提示

## [1.2.2] - 2021-07-05
大E了
### 修复

- 修复未在白名单内的玩家加入后服务端崩溃的bug

## [1.2.3] - 2021-07-05

### 更改

- 将插件内置白名单识别从uuid修改为xuid，以匹配官方原版白名单机制

## [1.3.0] - 2021-07-05

### 新增
- 加入@mcp setting reload，可直接在游戏内重载配置文件，并返回提示

### 更改
- 修改自定义死亡提示中的玩家名关键词

### 修复
- 反作弊初始化后不生效的bug
- 使用无效指令/越权使用指令后的提示中的@前缀未随设置修改的bug

## [1.4.0] - 2021-07-05
一天更新(水)七个版本的快乐
### 新增
- 加入@whitelist [add|remove] ，可直接在游戏内修改内置白名单

### 修复
- 帮助文件前缀未随设置修改的bug

### 移除
- @ban，其主要功能并入@whitelist remove

## [1.4.1] - 2021-07-06
好耶 出去玩了一天，水一条更新
### 修复
- 配置文件长度过长而被错误截断

## [1.4.2] - 2021-07-06
小更新再水一条
### 新增
- 服务器开服时间可通过配置文件修改，默认值为插件第一次初始化时间

### 更改
- 通过一个静态类PluginInfo来存储插件基本信息

## [1.5.0] - 2021-07-07

### 新增
- 特殊权限指令使用数组存储，可通过配置文件进行修改
- MCP指令前缀、反作弊系统开关可在游戏内通过@mcp setting进行快速修改

### 更改
- 优化特殊权限指令越权使用的识别方式，简化代码
- 简化反作弊系统状态识别部分代码

## [1.5.1] - 2021-07-09
(分不清什么时候该用静态类，什么时候该用实例类
### 更改
- 将服务器信息存储更改为静态类
- 服务器开服时间读取移到插件初始化阶段

## [1.6.0] - 2021-07-09
好像获取不到准确的CPU占用率
### 新增
- 加入@system [cpu|memory]用于获取服务器的CPU/内存占用率

## [1.7.0] - 2021-07-10
应某人要求的@qs，年轻人的第一个嵌套多线程
### 新增
- 实装QuickSleep @qs，可投票快速跳过夜晚

## [1.7.1] - 2021-07-10
感觉@qs逻辑以后得重写一下，还是怪怪的
### 更改
- 优化@qs计算逻辑，开始投票后即可显示需投票人数
- 优化@qs投票逻辑，玩家在支持票与反对票之间可相互转换

## [1.7.2] - 2021-07-10

### 更改
- 服务器内只有一个人时无法使用@qs

### 修复
- 多次使用@qs后人数不断累加

## [1.7.3] - 2021-07-10
最终还是开始打扰其它玩家了
### 更改
- 大量指令反馈可见范围的更改

## [1.8.0] - 2021-07-11
每次@qb的实装就意味着一个插件的灵感要断流了
### 新增
- 实装@qb，可在游戏内快速备份、回档、重启服务器

### 更改
- 优化初始化及配置文件加载逻辑，以适配@qb

## [1.9.0] - 2021-07-11
好耶，可以作更多次死
### 新增
- 加入多槽位@qb，最多可同时保存5份备份，并可独立添加注释
- 加入@qb list，用于获取各槽位信息(存档名、备份时间、注释)

### 更改
- 优化初始化逻辑，以适配多槽位@qb

## [1.9.1] - 2021-07-11
@qb主体没啥bug，针不戳
### 更改
- 完善@qb的相关提示
- 完善@qb时槽位有效性的检验(备份是否存在，槽位是否合法)

### 修复
- 修复@mcp help中对于槽位限定的错误

## [1.10.0] - 2021-07-14

### 新增
- 加入@sta auto，实现计分板自动切换

### 修复
- @kill后提示语中的玩家名不再改变
- @bot kill 无效

## [1.11.0] - 2021-07-17
非常非常简陋的在线时长榜(会重写的会重写的
### 新增
- 在线时长榜(分钟)

### 更改
- 将代码分离至不同.cs中

### 修复
- 计分板自动切换开启后Tasks刷屏
- 特殊情况下@whitelist remove失效

### 移除
- 使用榜Used

## [2.0.0] - 2021-07-24
好耶,时隔好久的大更新
### 新增
- 基于YAML的新配置文件
- 可自定义加载器类型
- 可自定义计分板自动切换频率
- 插件内置白名单/插件管理员加入开关
- 插件日志系统
- 控制台输出可自定义内容
- 插件功能禁用系统

### 更改
- 配置系统重写,配置文件修改为config.yml
- 插件目录修改至plugins/MCPromoter
- 后台反馈输出内容更全面
- 修改插件配置后无需重载配置文件即可生效

### 修复
- 在线时长榜后台提示刷屏

##[2.1.0] - 2021-07-25
为了更好地作死
### 新增
- 自动备份,槽位为[AUTO]
- @mcp setting 修改计分板自动切换频率/插件管理员/插件白名单
- 强制游戏模式
- 备份保存备份大小信息

### 修复
- @qb 失效bug
- 自动切换计分板开启后无法关闭

##[2.2.0] - 2021-07-26
论发现CsPlayer类
### 新增
- @network [ip|port|ping]   获取玩家IP地址/端口/延迟
- 更多输出可通过配置文件开关

### 更改
- 输出信息进一步完善

### 修复
- 强制游戏模式导致控制台及游戏内刷屏
- 未备份时使用@qb list闪退

##[2.3.0] - 2021-07-27
LoadConfig()逐渐承担起更多东西
### 新增
- 计分板自动切换重复关闭提示
- 服务器控制台可使用@mcp setting reload重载配置文件

### 更改
- @mcp setting reload可更新强制游戏模式/在线时间记录/自动备份状态

##[2.4.0] - 2021-07-29
面向Ctrl C+V
### 新增
- 剑溅射伤害 Damage Splash
- 通过配置文件修改剑溅射伤害开关状态及伤害数量上限
- 通过游戏内指令@mcp setting修改剑溅射伤害数量上限
- @network ping 延迟测试失败提示

### 更改
- 自动备份开始前5s进行提醒

### 修复
- 插件无法载入
- 标准化输出接口对格式化代码去除失误
- 文案bug

##[2.5.0] - 2021-07-29
不知道干啥时就动一动QB
### 新增
- 对存档名合法性及存档是否存在的检验
- @qb make时对存档是否存在的检验
- @mcp setting可在游戏中快捷开关剑溅射伤害

### 更改
- 当QuickBackup被禁用时自动备份将无法使用
- 部分围绕QuickBackup的文案

### 修复
- 在错误的时机重新写入配置文件

##[2.6.0] - 2021-07-30
大工程助手+鸽子提醒器
### 新增
- @calc 现可进行物品计量单位转化(n个=>x盒y组z个 / x盒y组z个=>n个)
- @om 离线消息.用于向离线玩家发送消息,其可在上线时收到
- 可通过配置文件/@mcp setting快速开关离线消息

### 更改
- @= 更名为 @calc
- 玩家数据可在关服后持续保存在本地

##[2.6.1] - 2021-07-30
### 修复
- 玩家数据在使用@mcp setting reload时错误地被重载

##[2.7.0] - 2021-07-30
真正滴假人
### 新增
- @bot call 将bot召唤至玩家所在位置
- 可通过配置文件禁用@bot
### 更改
- @bot 接入 FakePlayer

##[2.7.1] - 2021-07-30
### 修复
- bot死亡后服务端崩溃

##[2.7.2] - 2021-07-30
### 修复
- 帮助列表错误
- 
##[2.7.3] - 2021-08-05
### 更改
- 玩家上线逻辑优化
### 修复
- 死亡点纪录偏移

##[2.8.0] - 2021-08-08
重构好几天了(
### 新增
- @tp 玩家传送(支持开头匹配)
### 更改
- 指令系统优化,效率++
- 指令不再匹配大小写
- 默认屏蔽原版/tp
### 修复
- 指令异常匹配大小写
- 插件加载失败(?

##[2.8.1] - 2021-08-08
重构好几天了(
### 修复
- @bot list无响应

##[2.8.2] - 2021-08-08
重构好几天了(
### 更改
- QuickBackup支持外部调用